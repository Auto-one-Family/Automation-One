# OneWire MQTT Scan Command Test (OW-DISC-006)
# Validates onewire/scan command via MQTT
# Tests: MQTT-triggered device discovery, scan result published
# Timeout: 90000ms

name: OneWire MQTT Scan Command
version: 1
steps:
  # Boot sequence with MQTT connection
  - wait-serial: "MQTT connected"

  # Wait for system to be fully ready
  - wait-serial: "Phase 5: Actuator System READY"

  # Initial heartbeat confirms system is running
  - wait-serial: "heartbeat"

  # When onewire/scan command is received via MQTT:
  # (In actual test, would need MQTT injection)
  # The scan command triggers:
  # - "ONEWIRE SCAN COMMAND RECEIVED"
  # - "OneWire scan on GPIO X"
  # - "Scanning OneWire bus..."
  # - "OneWire scan complete: X devices found"
  # - "Publishing scan result to: kaiser/god/esp/XXX/onewire/scan_result"

  # For this test, verify the bus is ready to receive commands
  - wait-serial: "OneWire Bus Manager initialized"
