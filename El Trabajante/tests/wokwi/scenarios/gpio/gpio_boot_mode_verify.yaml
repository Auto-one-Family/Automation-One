# GPIO-BOOT-004 & GPIO-BOOT-005: Initial Pin Modes and Safe-Mode Flags
# ====================================================================
# Validates that:
# - All pins have mode == INPUT_PULLUP after initialization
# - All pins have in_safe_mode == true after initialization
#
# Test IDs: GPIO-BOOT-004, GPIO-BOOT-005
# Priority: HIGH
# Requirement: Every pin in pins_ vector has correct initial state
#
# Initial state for each GPIOPinInfo:
#   - pin: valid GPIO number
#   - owner[0]: '\0' (empty string)
#   - component_name[0]: '\0' (empty string)
#   - mode: INPUT_PULLUP
#   - in_safe_mode: true
#
# Firmware reference: gpio_manager.cpp lines 56-62

name: Initial Pin Modes and Safe-Mode Flags Correct
version: 1
steps:
  # Wait for boot to start
  - wait-serial: "ESP32 Sensor Network"

  # Wait for GPIO initialization
  - wait-serial: "GPIO SAFE-MODE INITIALIZATION"

  # Verify each pin is set to Safe-Mode (INPUT_PULLUP)
  # The DEBUG log shows each pin being set
  # Note: These logs only appear at LOG_DEBUG level
  # We verify the summary message instead
  - wait-serial: "All pins successfully set to Safe-Mode"

  # Alternative: If there were warnings, they would appear here
  # We verify NO warnings about failed verification
  # Success message confirms all pins passed verification

  # Verify initialization completes
  - wait-serial: "Safe-Mode initialization complete"

  # Verify Phase 1 completes (GPIO was successful)
  - wait-serial: "Phase 1: Core Infrastructure READY"

  # GPIO Manager checkbox in Phase 1 summary
  - wait-serial: "GPIO Manager"
